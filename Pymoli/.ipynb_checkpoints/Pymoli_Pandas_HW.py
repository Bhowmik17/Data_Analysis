
# coding: utf-8

# In[1]:


get_ipython().run_cell_magic('writefile', 'homeworkTitle.py', '\n#dependencies\nimport pandas as pd\nimport numpy as np\n\n#map to the path of data set\ndata_file = "purchase_data.csv"\n\n# read the file with pandas data frame; pymoli_df["Price"] = pymoli_df["Price"].map("${:.2f}".format)...\n#if used, error in average price calc as can\'t characterize string to float!!!!\n\npymoli_df = pd.read_csv(data_file)\n\npymoli_df.head()\n\n# # Player Count total Number of Players\ntotal_players = pymoli_df ["SN"].nunique()\nprint("Number of total players " + str(total_players))\n\n###Purchase Analysis (Total)---------------------------------------------------------------------------------------------------\n\n#Number of Unique Items\nunique_items = len(pymoli_df["Item ID"].unique())\nunique_items\n\n# Average Purchase Price\naverage_price = pymoli_df["Price"].mean()\naverage_price\n\n#Total Number of Purchases\nnumber_of_purchases = len(pymoli_df)\nnumber_of_purchases\n\n#Total Revenue\ntotal_revenue = pymoli_df ["Price"].sum()\ntotal_revenue\n\n###***purchasing Analysis (Total) summary_df1\ndf1 = pd.DataFrame({\n    "Number of Unique Items": [unique_items],\n    "Average Price" :[average_price],\n    "Number of Purchases" :[number_of_purchases],\n    "Total Revenue" :[total_revenue],\n})\n                                    \ndf1.head()\n\n###Gender Demographics----------------------------------------------------------------------------------------------------------\n\n# Count of Male, Female, Other/ Non-Disclosed Players\ngender_count = pymoli_df ["Gender"].value_counts()\ngender_count\n\n#Gender Percentage\ngender_percentage = (gender_count/total_players)*100\ngender_percentage.round(2)\n\n###***Gender Demographic summary_df2\ndf2 = pd.DataFrame({"Gender Count": gender_count, "Gender Percentage": gender_percentage.round(2)})\n    \ndf2.head()\n\n###Purchasing Analysis (Gender)-------------------------------------------------------------------------------------------------\n\n#Purchase Count by Gender\nPurchase_Count_by_Gender = pymoli_df.groupby("Gender")["SN"].count()\n\nPurchase_Count_by_Gender\n\n#Average Purchase Price by Gender\nAverage_Purchase_Price_by_Gender = pymoli_df.groupby("Gender")["Price"].mean()\nAverage_Purchase_Price_by_Gender.round(2)\n\n#Total Purchase Value by Gender\nTotal_Purchase_Value_by_Gender = pymoli_df.groupby("Gender")["Price"].sum()\nTotal_Purchase_Value_by_Gender.round(2)\n\n#Average Purchase Total per Person by Gender\nAverage_Purchase_Total_perPerson_by_Gender = Total_Purchase_Value_by_Gender/ gender_count\nAverage_Purchase_Total_perPerson_by_Gender.round(2)\n\n###***Purchasing Analysis (Gender)_df3\n\n#Purchasing Analysis by Gender\ndf3 = pd.DataFrame({"Purchase Count" : Purchase_Count_by_Gender, \n                    "Average Purchase Price" : Average_Purchase_Price_by_Gender.round(2),\n                    "Total Purchase Value" : Total_Purchase_Value_by_Gender, \n                    "Avg Purchase Total per Person" : Average_Purchase_Total_perPerson_by_Gender.round(2)})\n\ndf3.head()\n                    \n\n### Age Demographics * The below each broken into bins of 4 years (i.e. &lt;10, 10-14, 15-19, etc.)\n\n#Establish bins for age groups\n\nage_bins = [0, 9.90, 14.90, 19.90, 24.90, 29.90, 34.90, 39.90, 99999]\n\ngroup_names = ["<10", "10-14", "15-19", "20-24", "25-29", "30-34", "35-39", "40+"] \n\n#Categorize the existing players using the age bins. Hint: use pd.cut()\n\npymoli_df["Age Groups"] = pd.cut(pymoli_df["Age"], age_bins, labels = group_names)\npymoli_df.head()\n\n#Calculate count per age group\n\ncount_per_age_group = pymoli_df.groupby("Age Groups")["SN"].count()\n\ncount_per_age_group\n\n# Calculate percentage of age grp count\n\nAgeGroups_percentage = (count_per_age_group/total_players)*100\nAgeGroups_percentage.round(2)\n\n#summary data with Percentage of Players and Total Count_df4\n\ndf4 = pd.DataFrame({"Player Percentage per age group" : AgeGroups_percentage.round(2), \n                    "Age Group Count" : count_per_age_group})\n\ndf4                    \n\n# Purchase Count by age group\npurchase_count = pymoli_df.groupby("Age Groups")["SN"].count()\npurchase_count\n\n# Average Purchase Price by Age Groups\n\nAverage_Purchase_Price_by_Age_Groups = pymoli_df.groupby("Age Groups")["Price"].mean()\nAverage_Purchase_Price_by_Age_Groups.round(2)\n\n\n# Total Purchase Value\n\nTotal_Purchase_Price_by_Age_Groups = pymoli_df.groupby("Age Groups")["Price"].sum()\nTotal_Purchase_Price_by_Age_Groups.round(2)\n\n\n# Average Purchase Total per Person by Age Group\n\nAverage_Purchase_Total_per_Person_per_Age_Groups = Total_Purchase_Price_by_Age_Groups/count_per_age_group\nAverage_Purchase_Total_per_Person_per_Age_Groups.round(2)\n\n#Purchase Analysis (Age)_df5\n\ndf5 = pd.DataFrame({"Purchase Count" : purchase_count, \n                    "Average Purchase Price" : Average_Purchase_Price_by_Age_Groups.round(2), \n                    "Total Purchase Value" : Total_Purchase_Price_by_Age_Groups, \n                    "Average Purchase Total per Person": Average_Purchase_Total_per_Person_per_Age_Groups.round(2)})\ndf5.head(10)\n\n### Top Five Spenders\n\n# Purchase_Count by All\ndf6 = pymoli_df ["SN"].value_counts()\ndf6\n\n\n# Total Purchase Price by All\n\ndf7 = pymoli_df.groupby ("SN")["Price"].sum()\n\ndf7\n\n# Average Purchase Price by All\ndf8 = df7/df6\ndf8\n\n#create spender_df9 with df6, df7, df8\n\ndf9 = pd.DataFrame({"Purchase Count": df6,\n                    "Average Purchase Price" : df8,\n                    "Total Purchase Value": df7})\n\ndf9.head()\n\n# Identify the the top 5 spenders in the game by total purchase value\n\nTop_five_spenders = df9.sort_values(["Total Purchase Value"], ascending=False)\nTop_five_spenders.head()\n\n\n# MOST POPULAR item analysis\n\n# Purchase Count\ndf10 = pymoli_df.groupby(["Item ID", "Item Name"])["SN"].count()\n\n#Item Price\ndf11 = pymoli_df.groupby(["Item ID", "Item Name"])["Price"].mean()\n\n#Total Purchase Value\ndf12 = pymoli_df.groupby(["Item ID", "Item Name"])["Price"].sum()\n\n# Convert to DataFrame\n\ndf13 = pd.DataFrame({"Purchase Count":df10,\n                     "Item Price":df11,\n                     "Total Purchase Value":df12,\n                    })\n\ndf13.head()\n\nMost_Popular_items = df13.sort_values(["Purchase Count"], ascending=False)\nMost_Popular_items.head()\n\nMost_Profitable_items = df13.sort_values(["Total Purchase Value"], ascending=False)\nMost_Profitable_items.head()\n\n### Three observable trends based on the data:\n\n# * Most Players are Male and most purchases are made by Male; they contributed to almost 83% of revenue. \n# * Most players and buyers are in age group range 20-24 years; almost 63.4% of total players are in this age group.\n# * Most popular item was also the most profitable item, "Oathbreaker, Last Hope of the Breaking Storm"')

